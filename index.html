<!doctype html>
<html>
	<head>
		<title>MVW Intern Kalender</title>
		<meta charset="utf-8">
		<script src="bower_components/moment/moment.js"></script>
		<script src="bower_components/moment/locale/de.js"></script>
		<script src="bower_components/ractive/ractive.min.js"></script>
	</head>
	<body>
		<div id="calendar"></div>

		<!-- <div type="text/ractive" id="template"> -->
		<script type="text/ractive" id="template">
			<p>
				<button on-click="prev-month">←</button>
				<strong>{{monthname}}</strong>
				<button on-click="next-month">→</button>
			</p>
			<table>
				<tr>
					{{#weekdays}}
					<th>{{.}}</th>
					{{/weekdays}}
				</tr>
				{{#weeks}}
				<tr>
					{{#days}}
					<td>
						{{day}}{{#if outside}}*{{/if}}
						{{#if canAdd}}
						<button on-click="add-event">+</button>
						{{/if}}
						<ul>
							{{#each getDayEvents(moment) }}
							<li on-click="show-event">
								{{ formatTime(start) }}: {{title}}
							</li>
							{{/each}}
						</ul>
					</td>
					{{/days}}
				</tr>
				{{#if isSameWeek(days[0].moment, activeEvent.start) }}
				{{#activeEvent}}
				<tr>
					<td colspan=7>
						{{>event}}
					</td>
				</tr>
				{{/activeEvent}}
				{{/if}}
				{{/weeks}}
			</table>

			<!-- {{>event}} -->
			{{#if editingEvent}}
			{{#if id}}
			{{>editEvent}}
			{{else}}
			{{>newEvent}}
			{{/if}}
			{{else}}
			<h2>{{title}}<button on-click="hide-event">X</button></h2>
			<p>{{ formatDateTime(start) }} bis {{ formatTime(end) }}</p>
			<p>{{desc}}</p>
			<p>
				<button on-click="ack-event">Ich bin dabei</button>
				<button on-click="nack-event">Keine Zeit</button>
			</p>
			{{/if}}
			<!-- {{/event}} -->

			<!-- {{>newEvent}} -->
			<strong>Neuer Termin: {{ formatDate(start) }}</strong>
			{{#if type}}
			{{>eventForm}}
			{{else}}
			<ul>
				{{#types}}
				<li style="background: {{color}}"
				    on-click="set-event-type:{{name}}">
					{{name}}
				</li>
				{{/types}}
			</ul>
			{{/if}}
			<!-- {{/newEvent}} -->

			<!-- {{>editEvent}} -->
			<strong>Termin bearbeiten: {{ formatDate(start) }}</strong>
			{{>eventForm}}
			<!-- {{/editEvent}} -->

			<!-- {{>eventForm}} -->
			<form on-submit="submit-event">
				Titel: <input type="text" value="{{title}}" required><br>
				Beginn: <input type="time" value="{{inputStart}}" required><br>
				Dauer (h): <input type="number" value="{{inputDuration}}" min="0" required><br>
				Beschreibung: <textarea>{{desc}}</textarea><br>
				<input type="submit">
			</form>
			<!-- {{/eventForm}} -->
		</script>
		<script src="calendar.js"></script>

	</body>
</html>
